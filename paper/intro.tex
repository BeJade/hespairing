\section{Introduction}
\label{sec:intro}

Pairings on elliptic curves have various applications in cryptography,
ranging from very basic key exchange protocols,
such as one round tripartite Diffie--Hellman~\cite{2000/joux-ants}~\cite{2004/joux-tripartite},
to complicated protocols, such as
identity-based encryption~\cite{2001/boneh}~\cite{2002/horwitz}~\cite{2002/gentry}~\cite{2005/sahai}.
Pairings also help to improve currently existing protocols, 
such as signature schemes, to have shortest possible signatures~\cite{2004/boneh}.

Curves that are suitable for pairings are called {\emph{pairing-friendly curves}},
and these curves must satisfy specific properties.
It is extremely rare that a randomly generated elliptic curve is pairing-friendly, so pairing-friendly curves have to be generated in a special way.
Examples of famous and commonly used pairing-friendly curves include 
Barreto-Naehrig curves~\cite{2006/barreto} (BN curves),
Barreto-Lynn-Scott curves~\cite{2003/bls} (BLS curves), and
Kachisa-Schaefer-Scott curves~\cite{2008/kss} (KSS curves).

Performance of pairing-based cryptography relies on
elliptic-curve-point arithmetic, computation of line functions and pairing algorithms.
A pairing is a bilinear map from two elliptic curve groups $\mathbb{G}_1$ and $\mathbb{G}_2$ to
a target group $\mathbb{G}_T$.
%$e: \mathbb{G}_1 \times \mathbb{G}_2 \rightarrow \mathbb{G}_T$.
%where $\mathbb{G}_1, \mathbb{G}_2$ and $\mathbb{G}_T$ are groups of prime order $r$.
Therefore, to achieve a good performance, as well as having an efficient pairing algorithm,
it is also desirable to have a fast elliptic-curve-point arithmetic in both $\mathbb{G}_1$ and $\mathbb{G}_2$.

Security of pairings depends on the cost of solving discrete logarithm problem (DLP) in the three groups previously mentioned,
namely, $\mathbb{G}_1$, $\mathbb{G}_2$, and $\mathbb{G}_T$.
Since one can attack pairing-based protocols by attacking any of these three groups,
the cost of solving DLP must be sufficiently high in all of these three groups.
%Recall that $\mathbb{G}_1$ and $\mathbb{G}_2$ are elliptic-curve groups
%while $\mathbb{G}_T$ is a multiplicative group defined over a finite field.
%In general, DLP on the elliptic-curve side is more difficult than the finite field side.
%This means that the group size of the finite field has to be larger in order to have a balance security on both sides.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Choice of curves and embedding degrees}

One way to improve the performance of pairings is
to improve the performance of the underlying point arithmetic.
Since pairing computation arises naturally from a geometric representation of Weierstrass curves,
most pairing formulae use curves written in Weierstrass form.
However, the algorithms for performing arithmetic on elliptic curves in Weierstrass form is known to be quite slow compared to elliptic curves with special properties allowing them to be written in
%Alternative curve models other than the conservative Weierstrass curves have been proposed,
for example Hessian form~\cite{2001/smart}~\cite{2001/joye} or in
Edwards form~\cite{2007/edwards}~\cite{2007/bernstein-newelliptic}.

Pairings based on Edwards curves,
along with examples of pairing-friendly Edwards curves
were proposed by Arene, Lange, Naehrig and Ritzenthaler~\cite{2009/fastertate}.
They found that the computation of line functions necessary to compute the pairing is much more complicated than if the curves were written in Weierstrass form.
%since formulas to compute line function derive naturally from Weierstrass model.
In other words,
%the gain due to the fast point arithmetic on Edwards curves is outweighed by the loss of slow computation of line functions.
even though Edwards curves allow faster point arithmetic,
this gain is outweighed by the slower computation of line functions.
%the computation of line funcions is much slower which outweigh
%%leands to a slowdown in the overall computation of pairing.

Pairings based on Hessian curves have been considered by Gu, Gu and Xie~\cite{2010/Gu}.
They provided a geometric interpretation of the group law on Hessian curves
along with an algorithm for computing Tate pairing on elliptic curves in Hessian form.
However, no pairing-friendly curves in Hessian form were given.

Bos, Costello and Naehrig~\cite{2013/bos-pairing} investigated the possibility of first
using a model of a curve (such as Edwards or Hessian) allowing for fast group operations, then mapping to Weierstrass form for the computation of the pairing.
They found that for every elliptic curve $E$ in the BN-12, BLS-12, and KSS-18 families of pairing-friendly curves, if $E$ is isomorphic over $\FF_{p}$ to a curve in Hessian or Edwards form, then it is not isomorphic over $\FF_{p^{k}}$ to a curve in Hessian or Edwards form, where $k$ is the embedding degree, so that the computations in either $\mathbb{G}_1$ or $\mathbb{G}_2$ have to use slower algorithms for group operations on curves in Weierstrass form. Moreover, this idea of using different curve models comes at a cost of at least one conversion
between other curve models into Weierstrass curves.

Regardless of which model of elliptic curve was being studied, most of the previous articles on this topic were considering ``even'' embedding degrees. In this paper, we concentrate on curves with embedding degrees divisible by 3, as pairing-friendly elliptic curves in Hessian form are equipped with natural twists of degree 3. One of the main advantages of even embedding degrees is the applicability of a denominator elimination technique in the pairing computation, which is unfortunately not available for odd embedding degrees. In spite of this, pairing algorithms for curves in Weierstrass form with odd embedding degree have been shown previously to be competitive, for example in work by Lin, Zhao, Zhang and Wang in~\cite{2008/lin}, by Mrabet, Guillermin and Ionica in~\cite{2009/deg15}, and by Fouotsa, Mrabet and Pecha in~\cite{2016/degodd}. Also, due to recent advances in number field sieve techniques for attacking the discrete logarithm problem for pairing-friendly elliptic curves over finite fields, it is necessary to increase the size of the finite fields in which we are working for pairing-friendly curves, and one way of doing this is by increasing the embedding degree. This means increasing the current standard (even) embedding degrees $k=12$ and $k=18$, on which we give more details below.

%Originally, part of the pairing algorithms is to compute $l \leftarrow l_1/l_2$.
%In the case of even embedding degrees, $l_2$ will be mapped to one in a sequent step (final exponentiation).
%Therefore, a computation of $l_2$ and a division by $l_2$ can completely be ignored.
%On the other hands, $l_2$ will not be mapped to one for odd embedding degrees.
%Thus, this denominator elimination technique cannot be applied directly.

%Despite the disadvantage of having to compute $l_2$,
%pairings with odd embedding degrees have been considered before.
%A different technique of the denominator elimination for odd embedding degrees has been explained by
%Lin, Zhao, Zhang and Wang~\cite{2008/lin} which considered embedding degree 9 and by
%5Mrabet, Guillermin and Ionica~\cite{2009/deg15} which considered embedding degree 15.
%A recent article by Fouotsa, Mrabet and Pecha~\cite{2016/degodd} considered embedding degrees 9, 15, and 27.
%However, these works concern pairings on conventional Weierstrass curves.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Attacks on solving DLP over finite fields}

The series of advances in attacking the discrete logarithm problem for elliptic curves over finite fields,
i.e.,~\cite{2016/KB}~\cite{2015/BGGM}~\cite{2015/BGK},
have weakened the security of pairing-friendly elliptic curves by dramatically decreasing the security level on the finite field side.
In order to retain the security level, either the size of the prime field or the embedding degree (or both) has to be increased.
For example, BN-12 (BN curves with embedding degree 12) used to be very popular for 128-bit security level,
because a 256-bit prime field maps to a 3072-bit finite field
where the security on both the prime field side and the finite field side have a 128-bit security level.
%However, series of advancement in computing discrete logarithm in finite field, for instance,
%which have dramatically decreased the security level on the finite field side.
A recent article on ``Updating key size estimations for parings'' by Barbulescu and Duquesne~\cite{2017/keysize}
suggests that, for BN curves, the prime field has to be increased to over 400 bits in order to achieve 128-bit security level.
Increasing the field size has a penalty of slowing down arithmetic operations which creates a huge impact on performance.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Our contributions}

%xxx To Chloe: I don't know how to put these in this subsection.  Note that the attacks also apply to odd embedding degrees.  In general, they apply to all composite embedding degrees.
%However, recent advances in the number field sieve techniques (\cite{?})
%to attack the discrete logarithm problem for elliptic curves have significantly reduced the security of pairing-based cryptography
%for elliptic curves with even embedding degree.
%In this paper, we outline compute the reduced Tate pairing on elliptic curves in Hessian form,
%which have a natural degree 3 twist, so that the most natural embedding degrees to consider are multiples of 3.

In terms of the performance of pairing-based protocols,
the paper~\cite{2013/bos-pairing} by Bos, Costello and Naehrig
inspires the question whether it is possible to
construct pairing-friendly curves that could be represented in the same curve models,
preferably with fast point arithmetic and fast computation of line functions,
for both $\mathbb{G}_1$ and $\mathbb{G}_2$,

Twisted Hessian curves with faster point arithmetic have recently been proposed by
Bernstein, Lange, Chuengsatiansup and Kohel~\cite{2015/hessian}.
This leads to questions whether the newer point arithmetic would also lead to fast formulas for computing line functions,
and whether these formulas would be applicable to computing pairings on twisted Hessian curves.

We present the first construction (to our knowledge) of a pairing on curves in Hessian form with odd embedding degree. Note in particular that among the popular pairing-friendly curve families,
BN-12 and KSS-18 have embedding degrees 12 and 18 respectively, which gives a large difference in field size. Our results provide an alternative of embedding degree 15, in an attempt to give a better balance between the size of the prime field and of the embedding degree. For higher security level, our constructions allow, for example, embedding degrees 21 or 33.

%XXX add reference to section
The setup of this article is as follows:
in Section~\ref{sec:Tatepairing}, we recall Miller's algorithm to compute the reduced Tate pairing on an elliptic curve in Hessian form.
In Section~\ref{sec:?}, we observe that the efficiency of computing line functions on curves in Hessian form is similar to the Weierstrass case. %where is this?
In Section~\ref{sec:curves}, we state constructions of families of pairing-friendly elliptic curves given in \cite{2010/freeman} that can be written in twisted Hessian form and show how to use the degree 3 twists to optimize computations.
In Section~\ref{sec:formulas}, we state explicit formulae for the computation of the reduced Tate pairing on Hessian curves based on the state-of-the-art point arithmetic formulas.
In Section~\ref{sec:cmp}, we compare the efficiency of our algorithm with the Weierstrass case.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5

