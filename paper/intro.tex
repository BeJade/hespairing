\section{Introduction}
\label{sec:intro}

Pairings on elliptic curves have various applications in cryptography,
ranging from very basic key exchange protocols,
such as one round tripartite Diffie--Hellman~\cite{2000/joux-ants}~\cite{2004/joux-tripartite},
to complicated protocols, such as
identity-based encryption~\cite{2001/boneh}~\cite{2002/horwitz}~\cite{2002/gentry}~\cite{2005/sahai}.
Pairings also help to improve currently existing protocols, 
such as signature schemes, to have shortest possible signatures~\cite{2004/boneh}.

Curves that are suitable for pairings are called {\emph{pairing-friendly curves}},
and these curves must satisfy specific properties.
It is extremely rare that a randomly generated elliptic curve is pairing-friendly,
so pairing-friendly curves have to be generated in a specific way.
Examples of famous and commonly used pairing-friendly curves include 
Barreto-Naehrig curves~\cite{2006/barreto} (BN curves),
Barreto-Lynn-Scott curves~\cite{2003/bls} (BLS curves), and
Kachisa-Schaefer-Scott curves~\cite{2008/kss} (KSS curves).

Performance of pairing-based cryptography relies on
elliptic-curve-point arithmetic, computation of line functions and pairing algorithms.
A pairing is a bilinear map from two elliptic curve groups $\mathbb{G}_1$ and $\mathbb{G}_2$ to
a target group $\mathbb{G}_T$.
Therefore, to achieve a good performance, as well as having an efficient pairing algorithm,
it is also desirable to have a fast elliptic-curve-point arithmetic in both $\mathbb{G}_1$ and $\mathbb{G}_2$.

Security of pairings depends mainly on the cost of solving discrete logarithm problem (DLP) in the three groups previously mentioned,
namely, $\mathbb{G}_1$, $\mathbb{G}_2$, and $\mathbb{G}_T$.
Since one can attack pairing-based protocols by attacking any of these three groups,
the cost of solving DLP must be sufficiently high in all of these three groups.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Choice of curves and embedding degrees}

One way to improve the performance of pairings is
to improve the performance of the underlying point arithmetic.
Since pairing computation arises naturally from a geometric representation of Weierstrass curves,
most pairing formulas use curves written in Weierstrass form.
However, the algorithms for performing point arithmetic on elliptic curves in Weierstrass form
are known to be quite slow compared to elliptic curves with special properties allowing them to be written in,
for example, Hessian form~\cite{2001/smart}~\cite{2001/joye} or
Edwards form~\cite{2007/edwards}~\cite{2007/bernstein-newelliptic}.

Pairings based on Edwards curves,
along with examples of pairing-friendly Edwards curves,
were proposed by Arene, Lange, Naehrig and Ritzenthaler~\cite{2009/fastertate}.
They found that the computation of line functions necessary to compute the pairing
is much more complicated than if the curves were written in Weierstrass form.
%since formulas to compute line function derive naturally from Weierstrass model.
In other words,
%the gain due to the fast point arithmetic on Edwards curves is outweighed by the loss of slow computation of line functions.
even though Edwards curves allow faster point arithmetic,
this gain is outweighed by the slower computation of line functions.
%the computation of line functions is much slower which outweigh
%%leads to a slowdown in the overall computation of pairing.

Pairings based on Hessian curves with even embedding degrees have been considered by Gu, Gu and Xie~\cite{2010/Gu}.
They provided a geometric interpretation of the group law on Hessian curves
along with an algorithm for computing Tate pairing on elliptic curves in Hessian form.
However, no pairing-friendly curves in Hessian form were given.

Bos, Costello and Naehrig~\cite{2013/bos-pairing} investigated the possibility of first
using a model of a curve (such as Edwards or Hessian) allowing for fast group operations,
then mapping to Weierstrass form for the computation of the pairing.
They found that for every elliptic curve $E$ in the BN-12, BLS-12, and KSS-18 families of pairing-friendly curves,
if $E$ is isomorphic over $\F{q}$ to a curve in Hessian or Edwards form,
then it is not isomorphic over $\F{q^{k}}$ to a curve in Hessian or Edwards form,
where $k$ is the embedding degree, so that the computations in either $\mathbb{G}_1$ or $\mathbb{G}_2$
have to use slower algorithms for group operations on curves in Weierstrass form.
Moreover, this idea of using different curve models comes at a cost of at least one conversion
between other curve models into the Weierstrass form.

Regardless of which model of elliptic curve was being studied,
most of the previous articles on this topic were considering ``even'' embedding degrees.
One of the main advantages of even embedding degrees is the applicability of a denominator elimination technique in the pairing computation,
which is unfortunately not trivially available for odd embedding degrees.
Examples of pairing algorithms for curves in Weierstrass form with odd embedding degree include
the work by Lin, Zhao, Zhang and Wang in~\cite{2008/lin}, by Mrabet, Guillermin and Ionica in~\cite{2009/deg15},
and by Fouotsa, Mrabet and Pecha in~\cite{2016/degodd}.
In this paper, we concentrate on curves with embedding degrees divisible by 3,
as pairing-friendly elliptic curves in (twisted) Hessian form are equipped with natural twists of degree 3.

%Due to recent advances in number field sieve techniques for attacking the discrete logarithm problem for pairing-friendly elliptic curves over finite fields,
%it is necessary to increase the size of the finite fields for pairing-friendly curves.
%One way of doing this is by increasing the embedding degree.
%This means increasing the conventional even embedding degree 12 to 18 or to 24 for higher security levels (see below).

%Originally, part of the pairing algorithms is to compute $l \leftarrow l_1/l_2$.
%In the case of even embedding degrees, $l_2$ will be mapped to one in a sequent step (final exponentiation).
%Therefore, a computation of $l_2$ and a division by $l_2$ can completely be ignored.
%On the other hands, $l_2$ will not be mapped to one for odd embedding degrees.
%Thus, this denominator elimination technique cannot be applied directly.

%Despite the disadvantage of having to compute $l_2$,
%pairings with odd embedding degrees have been considered before.
%A different technique of the denominator elimination for odd embedding degrees has been explained by
%Lin, Zhao, Zhang and Wang~\cite{2008/lin} which considered embedding degree 9 and by
%5Mrabet, Guillermin and Ionica~\cite{2009/deg15} which considered embedding degree 15.
%A recent article by Fouotsa, Mrabet and Pecha~\cite{2016/degodd} considered embedding degrees 9, 15, and 27.
%However, these works concern pairings on conventional Weierstrass curves.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Attacks on solving DLP over finite fields}

The series of advances in attacking the discrete logarithm problem for elliptic curves over finite fields,
i.e.,~\cite{2013/jouxP}~\cite{2016/KB}~\cite{2015/BGGM}~\cite{2015/BGK},
have weakened the security of pairing-friendly elliptic curves by dramatically decreasing the security level on the finite field side.
In order to retain the security level, either the size of the prime field or the embedding degree (or both) has to be increased.
For example, BN-12 (BN curves with embedding degree 12) used to be very popular for 128-bit security level,
because a 256-bit prime field maps to a 3072-bit finite field
where the security on both the prime field side and the finite field side have a 128-bit security level.
%However, series of advancement in computing discrete logarithm in finite field, for instance,
%which have dramatically decreased the security level on the finite field side.
According to the recent articles
``Challenges with Assessing the Impact of NFS Advances on the Security of Pairing-based Cryptography''
by Menezes, Sarkar and Singh~\cite{2016/MSS}
and ``Updating key size estimations for parings'' by Barbulescu and Duquesne~\cite{2017/keysize},
it is advisable to increase the field size.
For example, the latter suggests that, for BN curves, the prime field has to be increased to over 400 bits in order to achieve 128-bit security level.
Increasing the field size has a penalty of slowing down arithmetic operations which has a huge impact on performance.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Our contributions}

In terms of the performance of pairing-based protocols,
the paper~\cite{2013/bos-pairing} by Bos, Costello and Naehrig
inspires the question whether it is possible to
construct pairing-friendly curves that could be represented in the same curve models,
preferably with fast point arithmetic and fast computation of line functions,
for both $\mathbb{G}_1$ and $\mathbb{G}_2$,

Twisted Hessian curves with faster point arithmetic have recently been proposed by
Bernstein, Chuengsatiansup, Kohel and Lange~\cite{2015/hessian}.
This leads to questions whether the newer point arithmetic would also lead to fast formulas for computing line functions,
and whether these formulas would be applicable to computing pairings on twisted Hessian curves.

We present concrete constructions of a pairing on curves in twisted Hessian form starting
from how to generate curves which guarantee to be representable in twisted Hessian form,
how to convert them into the twisted Hessian form, and
explicit formulas to compute pairings on such curves.
To our knowledge, we are the first to consider pairing on twisted Hessian curves with odd embedding degrees.
Our formulas for even embedding degrees are the fastest compared to previously published formulas despite the curve models.
%Note in particular that among the popular pairing-friendly curve families,
%BN-12 and KSS-18 have embedding degrees 12 and 18 respectively, which gives a large difference in field size.
%Our results provide an alternative of embedding degree 15,
%in an attempt to give a better balance between the size of the prime field and of the embedding degree.
%For higher security levels, our constructions allow, for example, embedding degrees 21 or 33.

The setup of this paper is as follows:
in Section~\ref{sec:background}, we recall Miller's algorithm to compute the optimal ate pairing on elliptic curves in twisted Hessian form.
In Section~\ref{sec:curves}, we state constructions of families of pairing-friendly elliptic curves given in~\cite{2010/freeman}
that can be written in twisted Hessian form and show the conversion.
In Section~\ref{sec:lines}, we observe that the efficiency of computing line functions on curves in twisted Hessian form is similar to the Weierstrass case
and explain how to compute them.
In Section~\ref{sec:even}, we state explicit formulas for the computation of the optimal ate pairing
on twisted Hessian curves having even embedding degrees based on the state-of-the-art point arithmetic formulas.
We also provide comparisons to previous works.
In Section~\ref{sec:odd}, we give explicit formulas for the odd embedding degree case
and a comparison.
In Section~\ref{sec:conclude}, we conclude our results and
remark on some advantages that do not obviously appear in the comparison tables.
%In Section~\ref{sec:formulas}, we state explicit formulas for the computation of the optimal ate pairing
%on twisted Hessian curves based on the state-of-the-art point arithmetic formulas.
%In Section~\ref{sec:cmp}, we compare our results to previous works.
%In Appendix~\ref{app:magma}, we provide full Magma codes for a toy example of pairing-friendly twisted Hessian curves with embedding degree $k = 21$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5

