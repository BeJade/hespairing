\section{Pairing-friendly Hessian curves}

Even though every elliptic curve can be written in a Weierstrass form,
only those that contain points of order 3 can be written in a Hessian form.
Almost all methods to generate pairing-friendly curves are for generating
pairing-friendly Weierstrass curves.
Therefore, one method to generate pairing-friendly Hessian curves is to
search through constructions of pairing-friendly Weierstrass curves for curves that have points of order 3,
then convert those curves into the Hessian form.

Let $E$ be an elliptic curve defined over a finite field $\F{q}$ where $q$ is prime.
Let $r$ be the largest prime-factor subgroup of $E(\F{q})$.
Define an \emph{embedding degree $k$} as the smallest integer $k$ such that $r | q^k -1$.
To construct parametric families of pairing-friendly curves for given polynomials $q(x)$ and $r(x)$,
one needs to search for some value $x_0$ that results in $q(x_0)$ being prime.
Then, there is an elliptic curve $E$ defined over $\F{q(x_0)}$ having a subgroup
of order $r(x_0)$ and an embedding degree $k$ with respect to $r(x_0)$.

Cyclotomic families are families of curves where the underlying field $K$ is a cyclotomic field,
the largest prime-factor subgroup $r$ is a cyclotomic polynomial,
and the field $K$ contains $\sqrt{-D}$ for some small discriminant $D$.
We searched through~\cite{2010/freeman} and found 3 cyclotomic-family constructions that satisfy our point-of-order-3 conditions.
These constructions are based on a cyclotomic field containing a cube root of unity,
i.e., fields contain $\sqrt{-3}$.
Therefore, we choose the discriminant $D = 3$.

The following constructions are for generating pairing-friendly Weierstrass curves
which can be converted into Hessian curves (see~\cite{2015/hessian} Section 5).
Note that twists of these curves (see Section~\ref{twist}) are also expressible in the Hessian form.
We categorized these constructions by embedding degrees.
Note that $q(x)$ is a prime field,
$r(x)$ is a subgroup of $E(\F{q(x)})$ which may not be prime,
and $t(x)$ is a trace of $E/\F{q(x)}$ defined as $t(x) = q(x) + 1 - \#E(\F{q(x)})$
where $\#E(\F{q(x)})$ denotes the number of points on $E(\F{q(x)})$.

%\subsection{Cyclotomic families}
%~\cite{2010/freeman}
%Moreover, the search was restricted to the curves such that twists of those curves (see section~\ref{twist})
%must also contain points of order 3.
%%to reduce the computation by working with twists of curves (see Section~\ref{twist}),
%%we focused on finding curves which allow their twists also have points of order 3.
%%In other words, curves that we found 
%%This means that those curves that we found are also expressible in the Hessian form.
%Having the original curves and their twists contain points of order 3,
%these curves are guaranteed to be expressible in the Hessian form.
%%we check for
%%- have point of order 3
%%- twist s also have point of order 3
%%- have q prime
%%- q and r prime 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Let $k$ be a positive integer with $k \le 1000$ and $18 \nmid k$.
\subsection{Construction 1: $k \equiv 3 \pmod{18}$}
%$k \equiv 3 \pmod{6}$ and
This construction follows Construction 6.6 in~\cite{2010/freeman}
under the first subcase where $k \equiv 3 \pmod{6}$.
Pairing-friendly curves having embedding degree $k \equiv 3 \pmod{18}$
can be constructed using the following polynomials:
\begin{align*}
r(x) &= \Phi_{2k}(x),	\\
t(x) &= x^{k/3+1} + 1,	\\
q(x) &= \frac{1}{3} (x^2 - x + 1) (x^{2k/3} - x^{k/3} + 1) + x^{k/3+1}.
\end{align*}
%try $k = 21$ $x = 3*2^5 + 2$
%have point of order 3, also on twist, have q prime, but not both q and r  prime
%$D = 3 -> d = 3$ can't have d=6 because doesn't divide k
%Because the discriminant $D = 3$ and $6 \nmid k$,
%the only possible twist is of degree $d = 3$.


\subsection{Construction 2: $k \equiv 9,15 \pmod{18}$}
%If $k \equiv 3 \pmod{6}$ and
This construction follows Construction 6.6 in~\cite{2010/freeman}
under the second subcase where $k \equiv 3 \pmod{6}$.
Pairing-friendly curves having embedding degree $k \equiv 9,15 \pmod{18}$
can be constructed using the following polynomials:
\begin{align*}
r(x) &= \Phi_{2k}(x),	\\
t(x) &= -x^{k/3+1} + x + 1,	\\
q(x) &= \frac{1}{3} (x+1)^2 (x^{2k/3} - x^{k/3} + 1) - x^{2k/3+1}.
\end{align*}
%try $k = 15, 33$
%$ 15: x = 3*2^{31} + 2$
%$ 33: 3*2^{10} + 2$
%have point or order 3, also on twist, have q prime, but not both q and r prime
%$D = 3 -> d = 3$ can't have d=6 because does't divide k
%Similar to the previous construction,
%this construction only allows twist of degree $3$.


\subsection{Construction 3: $k \equiv 0 \pmod{6}$ and $18 \nmid k$}
This construction follows the last case of Construction 6.6 in~\cite{2010/freeman}.
Pairing-friendly curves having embedding degree $k \equiv 0 \pmod{6}$ where $18 \nmid k$
can be constructed using the following polynomials:
\begin{align*}
r(x) &= \Phi_k(x),	\\
t(x) &= x+1,		\\
q(x) &= \frac{1}{3} (x-1)^2 (x^{k/3} - x^{k/6} + 1) + x.
\end{align*}
%try $k = 12$
%$x = 3*2^{63}$
%have point of order 3, also on twist, have q prime, have q and r prime
%$D = 3 -> d = 3,6$
%Even though this construction allows curves with embedding degree $6$,
%only curves with embedding degree $3$ can be expressed in Hessian for both
%the original curves and their twists.

%For $k = 15, 21, 33$, the only possible twist is cubic twist.
%For $k = 12$ even though twist of degree $2, 3, 4, 6$ are possible, 
%only cubic twist that allow the twist of curve to also be expressible in Hessian form.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\subsection{Twists of curves}
\subsection{Twists of degree $3$}
\label{twist}
%To reduce the cost of pairing computation, we considered the concept of twists of curves.
Let $E$ and $E'$ be elliptic curves over $\F{q}$.
We call $E'$ a twist of $E$ if $E$ and $E'$ are isomorphic over some extension field of $\F{q}$.
More precisely, $E'$ is a {\emph{degree-$d$ twist}} of $E$ if they are isomorphic over a degree $d$ extension and not over any smaller field.

Twists of curves speed up pairing computations by allowing arithmetic to take place in a subfield instead of the full extension field.
That is, instead of working over the full extension field $\F{q^k}$, a degree-$d$ twist makes it possible to work over a subfield $\F{q^{k/d}}$
given $d$ divides $k$.
The larger the degree of twist is, the smaller the subfield that can be.
Thus, it is desirable to use the highest degree of twist available.
However, the only possible degrees of twist are $d \in \{2,3,4,6\}$.

%To use the twists of curves, the degree $d$ must divide $k$.
%For the case $k \equiv 3 \pmod{18}$ and $k \equiv 9,15 \pmod{18}$,
%the only possible twisted degree is $d = 3$.
%For the case $k \equiv 0 \pmod{6}$ where $18 \nmid k$,
%all twisted degrees are possible, i.e., $d \in \{2,3,4,6\}$.

%Recall that we focus only on curves that both the curves and theirs twists contain points of order 3.
To express twists of curves in the Hessian form,
those twists must also contain points of order 3.
To check whether the twisted curve $E'$ of $E$ contains points of order 3 or not,
we use the formulas in~\cite{2006/hess} which state the number of points on twisted curves.
The formulas for calculating the number of points on twisted curves always come in pairs.
For example, the formulas for $d = 3$ stated in~\cite{2006/hess} are as follows:
\begin{align*}
\# E' (\F{q}) &= q + 1 - (3f - t) / 2 & with & \quad t^2 - 4q = -3f^2, \\
\# E' (\F{q}) &= q + 1 - (-3f- t) / 2 & with & \quad t^2 - 4q = -3f^2.
\end{align*}
To determine the right twist,
we use the fact that $\#E'(\F{q})$ must also be divisible by $r$ which is the subgroup of $E$.
There is exactly one of those two possible twists that satisfies this condition.

The only possible degree of twist for curves generated by Construction 1 and Construction 2 is of degree $3$.
Twists of curves generated by these constructions also contain points of order 3.
For Construction 3, even though it allows many possible degrees of twist,
only twist of degree $3$ that contain points of order 3.
In summary,
for all pairing-friendly Hessian curve constructions presented in previous sections,
the only possible degree of twist is of degree $d = 3$.
%we found that for all Construction 1, 2 and 3,
%the only possible twist is $d = 3$.

