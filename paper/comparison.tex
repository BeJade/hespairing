\section{Comparison}
\label{sec:cmp}

We would like to emphasize that:
\begin{itemize}
\item	Most of the previous work on this topic concentrated on even embedding degrees.
\item   Most of the previous work on the optimization of operation counts for doubling and addition concentrated on pairings for $\G{1} \times \G{2}$.
\item   To the best of our knowledge, previous research on Hessian curves for pairings did not utilize cubic twists and was only applicable for even embedding degrees.
\item   To the best of our knowledge, the only previous research on pairings for curves with odd embedding degrees used curves in Weierstrass form.
\end{itemize}

Table~\ref{tbl-cmp1} shows the costs of the computation of the Miller doubling step (DBL) and Table~\ref{tbl-cmp2} shows the costs of the Miller adding step (mADD) using mixed addition.
The first column gives the conditions on the embedding degree $k$.
Note that as this paper particularly concerns cubic twists, we include only embedding degrees that are divisble by 3.
The second column gives the curve models, where 
$\mathcal{J}$, $\mathcal{P}$, $\mathcal{E}$, $\mathcal{H}$ denote the
Weierstrass model with Jacobian coordinates, the
Weierstrass model with projective coordinates,
the Edwards model and the
Hessian model respectively.
We denote the cost of field multiplication and field squaring over the base field $\F{q}$ by $\mul$ and $\sqr$ respectively and $\Mul$ and $\Sqr$ denote the cost of field multiplication and field squaring over the extension field $\F{q^k}$ respectively.
The cost of multiplication by curve parameters is omitted from the table.

\begin{table}[h]
\centering
\caption{Comparison of DBL for $\G{1} \times \G{2}$ with different curve models and embedding degrees}

\begin{tabular}{| l | l | l | l}
\hline
\multicolumn{1}{|c|}{$k$}
&\multicolumn{1}{|c|}{Curve models}	&\multicolumn{1}{c|}{DBL}		\\
\hline
\multicolumn{1}{|c|}{\multirow{6}{*}{
$\begin{array}{c} \text{even,} \\ 6|k \end{array}$}}
&$\mathcal{J}$, \cite{2008/IonicaJoux08} \cite{2009/fastertate}
				&$(k + 1)\mul + 11\sqr + \Mul + \Sqr$		\\
&$\mathcal{J},a_4 = -3$, \cite{2009/fastertate}
				&$(k + 6)\mul + 5\sqr + \Mul + \Sqr$	\\
&$\mathcal{J},a_4 = 0$, \cite{2009/fastertate}		
				&$(k + 3)\mul + 8\sqr + \Mul + \Sqr$		\\
&$\mathcal{P},(a_4,a_6) = (0, b^2)$, \cite{2009/craig}
				&$(k + 3)\mul + 5\sqr + \Mul + \Sqr$		\\
&$\mathcal{E}$, \cite{2009/fastertate}			
				&$(k + 6)\mul + 5\sqr + \Mul + \Sqr$			\\
&$\mathcal{E},j=0$, \cite{2014/LWZ}
				&$\left(\frac{4k}{3}+ 4\right)\mul + 7\sqr  + \frac{1}{3}\Mul + \Sqr$\\
&$\mathcal{H}$, \cite{2010/Gu}	&$(k + 3)\mul + 6\sqr + \Mul + \Sqr$ 	\\
&$\mathcal{H},j=0$, this paper 	&
$ \left(\frac{2k}{3} + 5\right)\mul + 3\sqr + \frac{2}{3}\Mul + \Sqr$			\\
\hline
\multicolumn{1}{|c|}{\multirow{2}{*}{
$\begin{array}{c} \text{odd,} \\ 3|k \end{array}$}}
&$\mathcal{P}$, \cite{2010/CLN}	&$(k + 6)\mul + 7\sqr + \Mul + \Sqr$		\\
&$\mathcal{H},j=0$, this paper
&$ \left(\frac{4k}{3} + 5\right)\mul + 3\sqr + \frac{16}{9}\Mul + \frac{11}{9}\Sqr$
\\
\hline
\end{tabular}
\label{tbl-cmp1}

%\justify
%Note: ``Pre cost'' denotes the precomputation cost.
%This cost is already included in the first column.

\end{table}

\begin{table}[h]
\centering
\caption{Comparison of mADD for $\G{1} \times \G{2}$ with different curve models and embedding degrees}

\begin{tabular}{| l | l | l | l}
\hline
\multicolumn{1}{|c|}{$k$}
&\multicolumn{1}{|c|}{Curve models}	&\multicolumn{1}{c|}{mADD}	\\
\hline
\multicolumn{1}{|c|}{\multirow{6}{*}{
$\begin{array}{c} \text{even,} \\ 6|k \end{array}$}}
&$\mathcal{J}$, \cite{2008/IonicaJoux08} \cite{2009/fastertate}
		&$(k+ 6)\mul + 6\sqr + \Mul $	\\
&$\mathcal{J},a_4 = -3$, \cite{2009/fastertate}
	&$(k+ 6)\mul + 6\sqr + \Mul$	\\
&$\mathcal{J},a_4 = 0$, \cite{2009/fastertate}		
	&$(k + 6)\mul + 6\sqr + \Mul$	\\
&$\mathcal{P},(a_4,a_6) = (0, b^2)$, \cite{2009/craig}
		&$(k + 10)\mul + 2\sqr + \Mul$	\\
&$\mathcal{E}$, \cite{2009/fastertate}			
		&$(k+ 12)\mul + \Mul$	\\
&$\mathcal{E},j=0$, \cite{2014/LWZ}
				&$\left(\frac{4k}{3} + 12\right)\mul  + \frac{1}{3}\Mul$ \\
&$\mathcal{H}$, \cite{2010/Gu}	&$(k + 10)\mul + \Mul$	\\
&$\mathcal{H},j=0$, this paper 	&
$ \left(\frac{2k}{3} + 11\right)\mul + \frac{2}{3}\Mul$	\\
\hline
\multicolumn{1}{|c|}{\multirow{2}{*}{
$\begin{array}{c} \text{odd,} \\ 3|k \end{array}$}}
&$\mathcal{P}$, \cite{2010/CLN}		&$(k + 13)\mul + 3\sqr + \Mul$	\\
&$\mathcal{H},j=0$, this paper
&$\left(\frac{4k}{3} + 11\right)\mul + \frac{16}{9}\Mul + \frac{2}{9}\Sqr $	\\
\hline
\end{tabular}
\label{tbl-cmp1a}

%\justify
%Note: ``Pre cost'' denotes the precomputation cost.
%This cost is already included in the first column.

\end{table}

\begin{table}[h]
\centering
\caption{Comparison of the costs of DBL and mADD for $\G{2} \times \G{1}$ with different curve models and embedding degrees}

\begin{tabular}{| l | l | l | l |}
\hline
\multicolumn{1}{|c|}{$k$}
&\multicolumn{1}{|c|}{Curve models}	&\multicolumn{1}{|c|}{DBL}	&\multicolumn{1}{|c|}{mADD}	
\\
\hline
\multicolumn{1}{|c|}{\multirow{2}{*}{
$\begin{array}{c} \text{even,} \\ 6|k \end{array}$}}
& $\mathcal{P},j=0$, \cite{2009/fastertate}
& $\frac{41}{36}\Mul + \frac{41}{36}\Sqr$
& $\frac{4}{3}\Mul + \frac{1}{18}\Sqr$ \\
& $\mathcal{H},j=0$, this paper
& $\frac{4k}{3}\mul + \frac{7}{3}\Mul + \frac{14}{9}\Sqr $
& $k\mul + 3\Mul + \frac{2}{9}\Sqr$ \\
\hline
\multicolumn{1}{|c|}{\multirow{2}{*}{
$\begin{array}{c} \text{odd,} \\ 3|k \end{array}$}}
%& $\mathcal{P},j=0$, \cite{2009/fastertate}
%& $3k\mul + \frac{5}{3}\Mul + \frac{16}{9}\Sqr$
%& $3k\mul + \frac{22}{9}\Mul + \frac{5}{9}\Sqr$ \\
& $\mathcal{H},j=0$, this paper
& $\frac{4k}{3}\mul + \frac{7}{3}\Mul + \frac{14}{9}\Sqr $
& $k\mul + 3\Mul + \frac{2}{9}\Sqr$ \\
&&& \\
\hline
\end{tabular}
\label{tbl-cmp2}

%\justify
%Note: ``Pre cost'' denotes the precomputation cost.
%This cost is already included in the first column.

\end{table}

As is probably clear from Table \ref{tbl-cmp2}, to our knowledge there is very little research on the optimization of curve arithmetic with regards the computation of the Miller function 
that utilizes twists. 
In particular we believe that this is the first paper that studies the use of cubic twists for the efficient computation of the Miller line function for a pairing on $\G{2} \times \G{1}$
for curves with odd embedding degree.
Curve arithmetic in this context is discussed to some extent in \cite{2009/fastertate}, 
but the formulas given in Section 6 for the line function correspond to pairings on $\G{1} \times \G{2}$, so it appears that the authors chose to concentrate on pairings for $\G{1} \times \G{2}$ for odd embedding degree.

Comparing Tables \ref{tbl-cmp1}, \ref{tbl-cmp1a}, and \ref{tbl-cmp2}, it is clear that one iteration of Miller's loop is faster for a $\G{1} \times \G{2}$ pairing than for a $\G{2} \times \G{1}$ pairing.
However, there has been much research on minimizing the number of iterations of Miller's loop for both types of pairing which affects our analysis considerably.

For pairings on $\G{1} \times \G{2}$, the lowest number of iterations occurs for the twisted ate pairing when twists are available, or the reduced Tate pairing when twists are not available.
In this paper we are explictly addressing the first case, so the twisted ate pairing gives the minimal number of iterations. 
Let $t$ be the trace of Frobenius, let $T = t-1$, and let $d$ be the degree of the twist. The number of iterations of Miller's loop for the twisted ate pairing is given by $T_e$, where
$T_e \equiv T^e \pmod{r}$ and $1 < e | d$. 
Also $T$ is a $d^{\text{th}}$-root of unity in $\F{r}$, so when $d = 6$ the smallest value of
$T_e$ is $T_2$ where $T_2^3= r-1$, and when $d = 3$ the smallest value of $T_e$ is
$T_3 = r-1$. For more details on the twisted ate pairing see \cite{2006/hess}.

For pairings on $\G{2} \times \G{1}$, the lowest number of iterations occurs for the optimal ate pairing. The best-case-scenario (which can in principle occur for any embedding degree) is $x$ iterations of Miller's loop. For more details on the optimal ate pairing see \cite{2010/vercauteren}. 

To motivate the study of pairings of $\G{2} \times \G{1}$, 
we compare the number of iterations for $\G{1} \times \G{2}$ and $\G{2} \times \G{1}$ when $k$ is odd and divisible by 3. 
In all the pairing-friendly families given in this paper, the polynomial $r(x)$ is the $k^{\text{th}}$ or $2k^{\text{th}}$ cyclotomic polynomial, both of which have degree given by the Euler function $\varphi(k)$. 
That is, where the twisted ate pairing (on $\G{1} \times \G{2}$) requires $\log(r-1)$ iterations of Miller's loop,
the optimal ate pairing (on $\G{2} \times \G{1}$) requires only $\log(r)/\phi(k)$ iterations of Miller's loop. 
So, if we wish to deduce from Tables~\ref{tbl-cmp1}, \ref{tbl-cmp1a}, and~\ref{tbl-cmp2} which pairing should be used, as a rough guide we could divide the operation counts of Table~\ref{tbl-cmp2} by $\phi(k)$. We give a comparison in the two aforementioned cases $k=15$ and $k=21$ with the NFS attacks and their variants in mind.

\begin{example}
Suppose that $\sqr = \mul$ and set $k = 15$.
The best operation count for one iteration of the Miller loop to compute the twisted ate pairing (on $\G{1} \times \G{2}$) is given by projective coordinates at 
$478\mul$ for doubling and $256\mul$ for addition.
The (only) operation count for one iteration of the Miller loop to compute the optimal ate pairing (on $\G{2} \times \G{1}$) is given by Hessian coordinates at
$895\mul$ for doubling and $740\mul$ for addition. 
However, if optimal parameters can be found, the computation of the twisted ate pairing 
will require $8 = \phi(15)$ times as many iterations of the Miller loop as the computation of the optimal ate, so we expect the optimal ate pairing with Hessian coordinates to outperform the twisted ate pairing with projective coordinates by a factor of between 3 and 4
(exactly how much better the performance is depends on the Hamming weights of $x$ and $T_3$).
\end{example}

\begin{example}
Suppose that $\sqr = \mul$ and set $k = 21$.
The best choices for each pairing type are as in the previous example: 
for $\G{1} \times \G{2}$ projective coordinates uses $916\mul$ for doubling and $478\mul$ for addition per iteration loop,
and for $\G{2} \times \G{1}$ Hessian coorindates uses $1743\mul$ for doubling and $1442\mul$ for addition per iteration loop.
The twisted ate pairing ($\G{1} \times \G{2}$) requires $12 = \phi(21)$ times
as many iterations of the Miller loop as the optimal ate pairing ($\G{2} \times \G{1}$), 
so for a rough comparison of the performance of the two pairings we divide the operation counts for optimal ate by 12. 
Given the above, we expect the optimal ate pairing with Hessian coorinates to be the most efficient choice for $k=21$ as it should outperform the twisted ate pairing with projective Weierstrass coordinates by a factor of approximately 4.
\end{example}

Not included in Tables~\ref{tbl-cmp1}, \ref{tbl-cmp1a}, and \ref{tbl-cmp2} are the 
precomputation costs (which are relatively low for our constructions) and the final exponentiation costs (which are roughly uniform across all curve shapes).
%and group operations on twisted Hessian curves allow faster point arithmetic operations than Weierstrass curves. -- this *is* accounted for in the table!
A significant part of the precomputation cost for many models in the conversion
between curve models, which is not necessary for our constructions.
(Recall that for BN, BLS, and KSS, this conversion is always necessary if one wants to take advantage of
the fast point-arithmetic on Hessian or Edwards curves, as proven in~\cite{2013/bos-pairing}.)
%As explained in Section~\ref{subsec:w2h}, 
%this conversion costs $9\Mul + 2\Sqr + 5\mul$ plus one inversion and one cube root computation.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\subsection{Numerical comparison}
%Since we would like to focus on a better balance of field size and embedding degree,
%we would like to focus on odd embedding degrees with allow, for example, $k = 15, 21$.
%Therefore, we think it is the best to compare our result of odd embedding degree twist Hessian curves,
%with odd embedding degree Weierstrass curve~\cite{2010/CLN}.
%
%In many protocols based on pairings, there are usually only a few pairing computation but many operations in $\G{1}$ and less in $\G{2}$, and $\G{T}$.
%In this simple comparison analysis, we would like to focus only on exponentiation $\G{1}$ because there are more of these compared to $\G{2}$ and $\G{T}$.
%We would like to show how much we save for one exponentiation in $\G{1}$.
%
%Consider embedding degree $k = 15$.
%Let $q = 384$.
%According to~\cite{EFD} and~\cite{2013/bos-pairing}, for Weierstrass curves of a form $y^2 = x^3 + b$,
%point doubling costs $2\Mul + 5\Sqr$ and point addition costs $11\Mul + 5\Sqr$.
%For our twisted Hessian curves of a form $ax^3 + y^3 + 1 = 0$,
%point doubling costs $5\Mul + 2\Sqr$ and point additio costs $11\Mul$.
%Let consider $S = 0.8M$.
%This means that on Weierstrass curve, point doubling and point addition cost $6\Mul$ and $15\Mul$ respectively,
%while on twisted Hessian curves point doubling and point addition cost $6.6\Mul$ and $11\Mul$ respectively.
%Let consider double-and-add algorithm with window with 5.
%This means that one exponentiation costs
%$384(6\Mul) + 76(15\Mul) = 3444\Mul$ on Weierstrass curves, and
%$384(6.6\Mul) + 76(11\Mul) = 3370.4$ on twisted Hessian curves.
%One pairing on Weierstrass curves cost $15\Mul + 6\Mul + 7\Sqr = 26.6\Mul$.
%One pairing on twisted Hessian curves cost $15\Mul + 6\Mul + 7\Sqr = 26.6\Mul$.
%
%Even though pairing on odd embedding degree twisted Hessian curves might cost more than that on Weierstrass curves,
%but if we consider as a whole pairing protocols, we save more on the group operations.
%The example of numerial comarison above show this.



